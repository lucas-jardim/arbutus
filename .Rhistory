library(geiger)
library(OUwie)
knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(geiger)
library(OUwie)
library(tidyverse)
tree <- stree(128, type = "balanced", tip.label = as.character(c(1:128))) %>% compute.brlen()
plot(tree)
#Make nodes correspond to selective regimes
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make dataframe
df_species <- tree$tip.label
df_regime <- c(rep.int(1, 64), rep.int(2, (128-64)))
df <- data.frame(df_species, df_regime) %>% rename(Genus_species = df_species, Reg = df_regime)
#Now sim
sim_dat <- OUwie.sim(phy = tree, data = df, alpha = c(1e-10,1e-10), sigma.sq = c(0.45,0.90), theta0 = 1.0, theta = c(0,0))
#Fit the data
sim_fit <- OUwie(phy = tree, data = sim_dat, model = "BMS")
View(sim_fit)
tree <- stree(128, type = "balanced", tip.label = as.character(c(1:128))) %>% compute.brlen()
tree2 <- sim.bdtree(n = 128, seed = 69)
plot(tree)
plot(tree2)
#tree <- stree(128, type = "balanced", tip.label = as.character(c(1:128))) %>% compute.brlen()
tree <- sim.bdtree(n = 128, seed = 69)
plot(tree)
#Make nodes correspond to selective regimes
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make dataframe
df_species <- tree$tip.label
df_regime <- c(rep.int(1, 64), rep.int(2, (128-64)))
df <- data.frame(df_species, df_regime) %>% rename(Genus_species = df_species, Reg = df_regime)
#Now sim
sim_dat <- OUwie.sim(phy = tree, data = df, alpha = c(1e-10,1e-10), sigma.sq = c(0.45,0.90), theta0 = 1.0, theta = c(0,0))
#Fit the data
sim_fit <- OUwie(phy = tree, data = sim_dat, model = "BMS")
View(sim_fit)
View(sim_fit)
#Make nodes correspond to selective regimes
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make dataframe
df_species <- tree$tip.label
df_regime <- c(rep.int(1, 64), rep.int(2, (128-64)))
df <- data.frame(df_species, df_regime) %>% rename(Genus_species = df_species, Reg = df_regime)
#Now sim
sim_dat <- OUwie.sim(phy = tree, data = df, alpha = c(1e-10,1e-10), sigma.sq = c(0.45,0.90), theta0 = 1.0, theta = c(0,0))
#Fit the data
sim_fit <- OUwie(phy = tree, data = sim_dat, model = "BMS")
View(sim_fit)
sim_fit$solution
#Check distribution of estimates
fit_distribution <- replicate(OUwie(phy = tree, data = sim_dat, model = "BMS"))
#Check distribution of estimates
fit_distribution <- replicate(500 ,OUwie(phy = tree, data = sim_dat, model = "BMS", quiet = TRUE))
#Check distribution of estimates
fit_distribution <- replicate(500 ,OUwie(phy = tree, data = sim_dat, model = "BMS", quiet = TRUE, warn = FALSE))
View(fit_distribution)
fit_distribution[,5]
fit_distribution[5,]
solutions <- fit_distribution[7,]
View(solutions)
solutions[[1]]
solutions[[1]][2,]
get_sigma <- function(tbl){
tbl[2,]
}
get_sigma(solutions[[1]])
get_sigma <- function(tbl){
res <- tbl[2,]
res
}
get_sigma(solutions[[1]])
sigmas <- map_df(solutions, get_sigma)
View(sigmas)
knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(geiger)
library(OUwie)
library(tidyverse)
#tree <- stree(128, type = "balanced", tip.label = as.character(c(1:128))) %>% compute.brlen()
tree <- sim.bdtree(n = 128, seed = 69)
plot(tree)
#Make nodes correspond to selective regimes
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make dataframe
df_species <- tree$tip.label
df_regime <- c(rep.int(1, 64), rep.int(2, (128-64)))
df <- data.frame(df_species, df_regime) %>% rename(Genus_species = df_species, Reg = df_regime)
#Now sim
sim_dat <- OUwie.sim(phy = tree, data = df, alpha = c(1e-10,1e-10), sigma.sq = c(0.45,0.90), theta0 = 1.0, theta = c(0,0))
#Fit the data
sim_fit <- OUwie(phy = tree, data = sim_dat, model = "BMS")
View(sim_fit)
arbutus
library(arbutus)
arbutus
model_info()
model_info(sim_dat)
model_info(sim_fit)
model_info
UseMethod
?UseMethod
View(sim_fit)
?get
?attr
attr(sim_fit$model)
sim_fit$model
coef
?coef
coef(OUwie)
?setdiff
?switch
geo=get(data(geospiza))
tmp=treedata(geo$phy, geo$dat)
phy=tmp$phy
dat=tmp$data
#---- STORE RESULTS
brownFit <-  fitContinuous(phy, dat[,"wingL"], SE=NA, control=list(niter=50), ncores=2)
View(brownFit)
coef(brownFit)
sim_fit[["theta"]]
as.list(coef(brownFit))
sim_fit$solution[1]
sim_fit$solution[2]
sim_fit$solution
sim_fit$solution[3]
sim_fit$solution[4]
sim_fit[["phy"]][["node.label"]]
sim_fit[["phy"]][["edge"]]
sim_fit[["regime.weights"]]
plot.phylo(tree, show.node.label = TRUE)
sim_fit[["phy"]][["edge.length"]]
sim_fit[["phy"]][["edge"]]
sim_fit[["phy"]][["node.label"]]
#Make nodes correspond to selective regimes
tree$node.label <- c(1:127)
plot.phylo(tree, show.node.label = TRUE)
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make nodes correspond to selective regimes
tree$node.label <- c(1:127)
plot.phylo(tree, show.node.label = TRUE)
#Make nodes correspond to selective regimes
tree2 <- sim.bdtree(n = 10)
tree2$node.label <- c(1:9)
plot.phylo(tree2, show.node.label = TRUE)
#Make nodes correspond to selective regimes
tree2 <- sim.bdtree(n = 10)
tree2$node.label <- c(rep.int(1, 5), rep.int(2, (10-4)))
plot.phylo(tree2, show.node.label = TRUE)
tree2$node.label <- c(rep.int(1, 5), rep.int(2, (10-6)))
plot.phylo(tree2, show.node.label = TRUE)
#Make nodes correspond to selective regimes
tree2 <- sim.bdtree(n = 10)
tree2$node.label <- c(rep.int(1, 5), rep.int(2, (10-6)))
plot.phylo(tree2, show.node.label = TRUE)
tree2$edge
tree2$node.label <- c(1:9)
plot.phylo(tree2, show.node.label = TRUE)
tree2$node.label <- c(rep.int(1, 5), rep.int(2, (10-6)))
plot.phylo(tree2, show.node.label = TRUE)
tree2$node.label
tree2$edge.length[1:2*5]
tree2$edge.length[1:10]
sum(tree2$node.label == 1)
test <- tree2$edge.length
n = sum(tree2$node.label == 1)
test[1:n] <- test[1:n] * 0
test[n+1:length(test)] <- test[n+1:length(test)] * 10
test
length(test)
View(tree2)
tree2[["edge.length"]]
test <- tree2$edge.length
test
test[1:2n] <- test[1:2n] * 0
test[1:2*n] <- test[1:2*n] * 0
test
test <- tree2$edge.length
test[1:(2*n)] <- test[1:(2*n)] * 0
test
test[(2*n+1):length(test)] <- test[(2*n+1):length(test)] * 10
test
length(test)
2*n+1
test[11:18] <- test[11:18] * 10
test
test <- tree2$edge.length
test
test[(2*n+1):length(test)] <- test[(2*n+1):length(test)] * 10
test
knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(geiger)
library(OUwie)
library(tidyverse)
#tree <- stree(128, type = "balanced", tip.label = as.character(c(1:128))) %>% compute.brlen()
tree <- sim.bdtree(n = 128, seed = 69)
plot(tree)
#Make nodes correspond to selective regimes
tree2 <- sim.bdtree(n = 10)
tree2$node.label <- c(rep.int(1, 5), rep.int(2, (10-6)))
plot.phylo(tree2, show.node.label = TRUE)
tree$node.label <- c(rep.int(1, 64), rep.int(2, (128-65)))
plot.phylo(tree, show.node.label = TRUE)
#Make dataframe
df_species <- tree$tip.label
df_regime <- c(rep.int(1, 64), rep.int(2, (128-64)))
df <- data.frame(df_species, df_regime) %>% rename(Genus_species = df_species, Reg = df_regime)
#Now sim
sim_dat <- OUwie.sim(phy = tree, data = df, alpha = c(1e-10,1e-10), sigma.sq = c(0.45,0.90), theta0 = 1.0, theta = c(0,0))
#Fit the data
sim_fit <- OUwie(phy = tree, data = sim_dat, model = "BMS")
arbutus(sim_fit)
arbutus::arbutus(sim_fit)
devtools::check()
arbutus::arbutus(sim_fit)
